<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√ÅO S·ª¨A THI·∫æT B·ªä</title>
    <!-- Bootstrap CSS (phi√™n b·∫£n 5.1.3) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">
    <!-- Font Awesome (ch·ªâ m·ªôt li√™n k·∫øt) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Th∆∞ vi·ªán jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <!-- Bootstrap JS (phi√™n b·∫£n 5.1.3 t∆∞∆°ng ·ª©ng v·ªõi CSS Bootstrap 5.1.3) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <!-- Th∆∞ vi·ªán SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Th∆∞ vi·ªán FileSaver -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
    <!-- Th∆∞ vi·ªán giao ti·∫øp script -->
    <script src="https://apis.google.com/js/platform.js"></script>
    <style>
      body {
        background-color: #f8f9fa;
        font-family: Arial, sans-serif;
      }

      .container {
        max-width: 100%;
        margin-top: 20px;
      }

      /* TH√îNG B√ÅO N·∫†P D·ªÆ LI·ªÜU */
      /* V√πng loading */
      .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background-color: #f4f4f4;
        z-index: 9999;
        transition: opacity 0.5s ease, visibility 0.5s ease;
      }

      .loading-screen.hidden {
        opacity: 0;
        visibility: hidden;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 5px solid #ddd;
        border-top-color: #3498db;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        from {
          transform: rotate(0deg);
        }

        to {
          transform: rotate(360deg);
        }
      }

      .loading-message {
        margin-top: 20px;
        font-size: 16px;
        color: #333;
        text-align: center;
      }

      /* H·ªòP THOAI ƒêƒÇNG NH·∫¨P */
      #loginSection {
        width: 400px;
        margin: 100px auto;
        padding: 20px;
      }

      .card {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        border: none;
        padding: 10px;
        /* Th√™m padding ƒë·ªÉ t·∫°o kho·∫£ng c√°ch 10px */
      }

      .card-header {
        background-color: #007bff;
        color: #fff;
        font-size: 1.25rem;
        font-weight: bold;
        text-align: center;
      }

      .password-field {
        position: relative;
      }

      .toggle-password {
        position: absolute;
        top: 50%;
        right: 10px;
        transform: translateY(-50%);
        cursor: pointer;
      }

      .section {
        display: none;
        padding: 5px;
      }

      .dashboard {
        margin-left: 10px;
        margin-right: 10px;
        display: none;
      }

      .nav-pills .nav-link.active {
        background-color: #007bff;
        color: #fff;
      }

      .tab-content .tab-pane {
        padding: 15px;
        padding-left: 10px;
        padding-right: 10px;
        border-top: none;
        background-color: #ffffff;
      }

      /* TABLE S·ª¨A CH·ªÆA */
      .custom-table {
        border-collapse: collapse;
        width: 100%;
        border: 1px solid #ddd;
        font-size: 18px;
      }

      .custom-table th,
      .custom-table td {
        text-align: left;
        padding: 12px;
      }

      .custom-table tr {
        border-bottom: 1px solid #ddd;
      }

      .custom-table tr.tb_header,
      .custom-table tr:hover {
        background-color: #f1f1f1;
      }

      /* N√öT ƒêI·ªÄU KHI·ªÇN TRONG B·∫¢NG  */
      .action-buttons button {
        padding: 5px 10px;
        margin: 2px;
        cursor: pointer;
      }

      .edit-button {
        background-color: #4CAF50;
        /* M√†u n·ªÅn xanh cho n√∫t Edit */
        color: white;
        border: none;
      }

      .delete-button {
        background-color: #f44336;
        /* M√†u n·ªÅn ƒë·ªè cho n√∫t X√≥a */
        color: white;
        border: none;
      }

      //SPIN WAITING
      .modal {
        display: none;
        /* ·∫®n modal m·∫∑c ƒë·ªãnh */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        /* N·ªÅn m·ªù */
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      }

      .spinner {
        border: 8px solid #f3f3f3;
        /* M√†u n·ªÅn */
        border-top: 8px solid #3498db;
        /* M√†u xoay */
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
        /* Kho·∫£ng c√°ch gi·ªØa spinner v√† text */
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        font-size: 16px;
        color: #333;
        font-weight: bold;
      }

      /* H·ªòP THO·∫†I EDIT  */
      body {
        font-family: Arial, sans-serif;
        background-color: #f9f9f9;
        padding: 20px;
      }

      h1 {
        text-align: center;
        color: #444;
      }

      #dataTable {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }

      #dataTable th,
      #dataTable td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: center;
      }

      #dataTable th {
        background-color: #4CAF50;
        color: white;
      }

      #editDialog {
        display: none;
        position: fixed;
        top: 5%;
        left: 50%;
        transform: translate(-50%, 0);
        width: 95%;
        max-width: 900px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        overflow: hidden;
      }

      .dialog-header {
        background-color: #4CAF50;
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 18px;
        font-weight: bold;
      }

      .dialog-body {
        padding: 20px;
      }

      .accordion {
        background-color: #f1f1f1;
        color: #444;
        cursor: pointer;
        padding: 15px;
        width: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 16px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #ddd;
      }

      .panel {
        display: none;
        padding: 15px;
        background-color: #f9f9f9;
        overflow-y: auto;
        /* Cho ph√©p cu·ªôn theo chi·ªÅu d·ªçc */
        max-height: 300px;
        /* ƒê·∫∑t chi·ªÅu cao t·ªëi ƒëa */
        border-left: 4px solid #4CAF50;
      }

      .form-group {
        display: flex;
        margin-bottom: 10px;
      }

      .form-group label {
        flex: 0 0 30%;
        font-weight: bold;
        color: #555;
      }

      .form-group input,
      .form-group select {
        flex: 1;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        background-color: #f8f8f8;
        min-width: 0;
      }

      .double-input {
        display: flex;
        justify-content: space-between;
      }

      .double-input .form-group {
        flex: 0 0 48%;
      }

      .dialog-footer {
        display: flex;
        justify-content: space-between;
        padding: 15px;
        background-color: #f1f1f1;
      }

      .dialog-footer button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 4px;
        flex: 1;
        margin: 0 5px;
      }

      .btnclose {
        background-color: #f44336;
        /* M√†u ƒë·ªè cho n√∫t ƒê√≥ng */
        color: white;
      }

      .btn-save {
        background-color: #4CAF50;
        /* M√†u xanh cho n√∫t L∆∞u */
        color: white;
      }

      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        display: none;
      }
    </style>
    <script>
      // N·∫†P D·ªÆ li·ªáu
      let id_user;
      let id_sc;
      let status_sc; 
      var mydata = []
      var mycol = []
      window.addEventListener('DOMContentLoaded', loadulieuAll); // N·∫°p d·ªØ li·ªáu t·∫•t c·∫£
      function loadulieuAll() {
        google.script.run.withSuccessHandler(function(dataout) {
          const data = JSON.parse(dataout); // Ph√¢n t√≠ch chu·ªói JSON th√†nh ƒë·ªëi t∆∞·ª£ng
          filldata_all(data); // G·ªçi h√†m filldata_all v·ªõi d·ªØ li·ªáu tr·∫£ v·ªÅ
        }).getdata();
      }
      // ƒêI·ªÄN D·ªÆ LI·ªÜU V√ÄO LIST
      function filldata_all(dataout) {
        const loadingScreen = document.getElementById('loading');
        loadingScreen.classList.add('hidden');
        mycol = dataout.mycol;
        mydata = dataout;
        const loginForm = document.getElementById('loginSection');
        loginForm.style.display = 'block';
      }

      function reloadData() {
        loadulieuAll(); // G·ªçi l·∫°i h√†m loadulieuAll ƒë·ªÉ n·∫°p l·∫°i d·ªØ li·ªáu t·ª´ Google Apps Script
      }


    function updatetable_all() {
      try {
        // L·∫•y c√°c b·∫£ng theo ID
        const history_baohong = document.getElementById("history_baohong");
        const history_dangsua = document.getElementById("history_dangsua");
        const history_baohanh = document.getElementById("history_baohanh");
        const history_suangoai = document.getElementById("history_suangoai");

        // Ki·ªÉm tra s·ª± t·ªìn t·∫°i c·ªßa b·∫£ng
        if (!history_baohong || !history_dangsua || !history_baohanh || !history_suangoai) {
          showinfor("Kh√¥ng t√¨m th·∫•y b·∫£ng trong giao di·ªán.");
          return;
        }

        // X√≥a d·ªØ li·ªáu c≈© trong tbody
        history_baohong.innerHTML = '';
        history_dangsua.innerHTML = '';
        history_baohanh.innerHTML = '';
        history_suangoai.innerHTML = '';

        // Ki·ªÉm tra d·ªØ li·ªáu
        if (!mydata.val_DataSC || mydata.val_DataSC.length <= 1) {
          history_baohong.innerHTML = '<tr><td colspan="3">Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>';
          history_dangsua.innerHTML = '<tr><td colspan="3">Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>';
          history_baohanh.innerHTML = '<tr><td colspan="3">Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>';
          history_suangoai.innerHTML = '<tr><td colspan="3">Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>';
          return;
        }

        // Bi·∫øn ƒë·∫øm STT
        const stt = {
          baohong: 0,
          dangsua: 0,
          baohanh: 0,
          suangoai: 0
        };
        // Duy·ªát qua c√°c d√≤ng d·ªØ li·ªáu
        mydata.val_DataSC.slice(1).forEach((item) => {
          const status = item[mycol.DataSC.trangthai];
          let targetTable = null;
          let currentSTTKey = null;
          let btnWord;
          // Ki·ªÉm tra tr·∫°ng th√°i
          if (status === 1) {
            targetTable = history_baohong;
            currentSTTKey = "baohong"; // Load t·∫•t c·∫£ d·ªØ li·ªáu
          } else if (item[mycol.DataSC.idusersua]?.toLowerCase() === id_user) {
            if (status === 2) {
              targetTable = history_dangsua;
              currentSTTKey = "dangsua";
            } else if (status === 3) {
              targetTable = history_baohanh;
              currentSTTKey = "baohanh";
            } else if (status === 4) {
              targetTable = history_suangoai;
              currentSTTKey = "suangoai";
            }
          }

          // B·ªè qua n·∫øu kh√¥ng c√≥ b·∫£ng ph√π h·ª£p
          if (!targetTable) return;

          stt[currentSTTKey]++;
          const row = document.createElement("tr");

          // C·ªôt STT
          const cellSTT = document.createElement("td");
          cellSTT.textContent = stt[currentSTTKey];

          // C·ªôt N·ªôi dung
          const idthietbi = item[mycol.DataSC.idthietbi];
          const rowsthietbi = mydata.val_dsthietbi.filter(item => item[mycol.DSThietBi.id] === idthietbi);
          if (rowsthietbi.length === 0) {
            showwarning("Kh√¥ng t√¨m th·∫•y thi·∫øt b·ªã v·ªõi id: " + idthietbi);
            return;
          }
          const rowthietbi = rowsthietbi[0];
          const idusersua = item[mycol.DataSC.idusersua];
          const rowsnguoisua = mydata.val_DSUserSua.filter(item => item[mycol.DSUserSua.id] === idusersua);
          if (rowsnguoisua.length === 0) {
            showwarning("Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi s·ª≠a v·ªõi id: " + idusersua);
            return;
          }
          const rownguoisua = rowsnguoisua[0];

          const cellNoiDung = document.createElement("td");
          const content = `‚ö†Ô∏è ${item[mycol.DataSC.id]} üõ†Ô∏è ${item[mycol.DataSC.tinhtrangtbdvbao]}
            <br> ‚ôüÔ∏è${rowthietbi[mycol.DSThietBi.id]} ‚öôÔ∏è${rowthietbi[mycol.DSThietBi.tentb]} ‚öôÔ∏è${rowthietbi[mycol.DSThietBi.model]}
            <br> üë®‚Äçüîß${rownguoisua[mycol.DSUserSua.hoten]} üìÖ${item[mycol.DataSC.ngaydonvibao]}`;
          cellNoiDung.innerHTML = content;

          // C·ªôt H√†nh ƒë·ªông (ch·ªâ th√™m n√∫t khi tr·∫°ng th√°i l√† "baohong")
          const cellHanhDong = document.createElement("td");
          const btnEdit = document.createElement("button");
          btnEdit.classList.add("btn", "btn-primary", "btn-sm");
          btnEdit.setAttribute("onclick", `editreport('${item[mycol.DataSC.id]}')`);
          btnEdit.innerHTML = '<i class="fas fa-edit"></i>';
          cellHanhDong.appendChild(btnEdit);


          if (status === 1) {
            //S·ª± ki·ªán next status 
            //s·ª± ki·ªán pdf 
            if(item[mycol.DataSC.url_vttb_09_02]!==""){
              const btn0902= document.createElement("button");
              btn0902.classList.add("btn", "btn-secondary", "btn-sm");
              btn0902.setAttribute("onclick", `window.open('${item[mycol.DataSC.url_vttb_09_02]}', '_blank')`);
              btn0902.innerHTML = '<i class="fas fa-file-pdf"></i> BM.09.02';
              btn0902.id = "btn0902" + item[mycol.DataSC.id];
              //s·ª± ki√™n 
              cellHanhDong.appendChild(btn0902);
            }
           
          } else if (item[mycol.DataSC.idusersua]?.toLowerCase() === id_user) {
            if (status === 2) {
              if(item[mycol.DataSC.url_vttb_09_03] !==""){
                const btn0903= document.createElement("button");
                btn0903.classList.add("btn", "btn-secondary", "btn-sm");
                btn0903.setAttribute("onclick", `window.open('${item[mycol.DataSC.url_vttb_09_03]}', '_blank')`);
                btn0903.innerHTML = '<i class="fas fa-file-pdf"></i> BM.09.03';
                btn0903.id = "btn0903" + item[mycol.DataSC.id];
                cellHanhDong.appendChild(btn0903);
              }
              if(item[mycol.DataSC.url_vttb_09_04] !==""){
                const btn0904= document.createElement("button");
                btn0904.classList.add("btn", "btn-secondary", "btn-sm");
                btn0904.setAttribute("onclick", `window.open('${item[mycol.DataSC.url_vttb_09_04]}', '_blank')`);
                btn0904.innerHTML = '<i class="fas fa-file-pdf"></i> BM.09.04';
                btn0904.id = "btn0904" + item[mycol.DataSC.id];
                cellHanhDong.appendChild(btn0904);
              }
            } else if (status === 3) {
              if(item[mycol.DataSC.url_vttb_09_04] !==""){
                const btn0904= document.createElement("button");
                btn0904.classList.add("btn", "btn-secondary", "btn-sm");
                btn0904.setAttribute("onclick", `window.open('${item[mycol.DataSC.url_vttb_09_04]}', '_blank')`);
                btn0904.innerHTML = '<i class="fas fa-file-pdf"></i> BM.09.04';
                btn0904.id = "btn0904" + item[mycol.DataSC.id];
                cellHanhDong.appendChild(btn0904);
              }
            } else if (status === 4) {
              if(item[mycol.DataSC.url_vttb_09_04] !==""){
                const btn0904= document.createElement("button");
                btn0904.classList.add("btn", "btn-secondary", "btn-sm");
                btn0904.setAttribute("onclick", `window.open('${item[mycol.DataSC.url_vttb_09_04]}', '_blank')`);
                btn0904.innerHTML = '<i class="fas fa-file-pdf"></i> BM.09.04';
                btn0904.id = "btn0904" + item[mycol.DataSC.id];
                cellHanhDong.appendChild(btn0904);
              }
            }
          }
          const btnNext = document.createElement("button");
          btnNext.classList.add("btn", "btn-primary", "btn-sm");
          btnNext.innerHTML = '<i class="fas fa-forward"></i> Qua b∆∞·ªõc ti·∫øp theo';
          btnNext.id = "btnNext" + item[mycol.DataSC.id];
          btnNext.addEventListener("click", () => {
                nextstatus(item[mycol.DataSC.id]); // G·ªçi h√†m nextstatus v·ªõi ID c·ªßa item
            });
          cellHanhDong.appendChild(btnNext);
          // Th√™m c√°c √¥ v√†o d√≤ng
          row.appendChild(cellSTT);
          row.appendChild(cellNoiDung);
          row.appendChild(cellHanhDong);

          // Th√™m d√≤ng v√†o b·∫£ng t∆∞∆°ng ·ª©ng
          targetTable.appendChild(row);
        });

        // C·∫≠p nh·∫≠t tab s·ªë l∆∞·ª£ng
        document.getElementById('tab-baohong').textContent = `B√°o h·ªèng (${stt.baohong})`;
        document.getElementById('tab-dangsua').textContent = `ƒêang s·ª≠a (${stt.dangsua})`;
        document.getElementById('tab-baohanh').textContent = `B·∫£o h√†nh (${stt.baohanh})`;
        document.getElementById('tab-suangoai').textContent = `S·ª≠a ngo√†i (${stt.suangoai})`;
      } catch (error) {
        console.error("L·ªói khi c·∫≠p nh·∫≠t b·∫£ng:", error);
        showinfor("ƒê√£ x·∫£y ra l·ªói: " + error.message);
      }
    }

    function nextstatus(id) {
        id_sc = id 
          try {
              showyesno("B·∫°n c√≥ mu·ªën chuy·ªÉn qua tr·∫≠ng th√°i ti·∫øp theo cho ID [" + id_sc + "] kh√¥ng?", "C·∫≠p nh·∫≠t d·ªØ li·ªáu").then((rs) => {
                  if (rs === 1) {
                      try {
                          showLoading();
                          closeDialog();
                          google.script.run
                              .withSuccessHandler((result) => {
                                  try {
                                      mydata.val_DataSC = result;
                                      updatetable_all();  
                                      hideLoading();
                                      showwarning("ƒê√£ c·∫≠p nh·∫≠t th√†nh c√¥ng d·ªØ li·ªáu");
                                  } catch (e) {
                                      handleFunctionError("X·ª≠ l√Ω th√†nh c√¥ng", e);
                                  }
                              })
                              .withFailureHandler((error) => {
                                  console.error("L·ªói t·ª´ Apps Script:", error);
                                  alert("C√≥ l·ªói x·∫£y ra khi g·ªçi Apps Script: " + error);
                                  hideLoading();
                              })
                              .SC_nextstatus(id_sc);
                      } catch (e) {
                          handleFunctionError("Quy tr√¨nh l∆∞u d·ªØ li·ªáu", e);
                      }
                  } else {
                      console.log("Ng∆∞·ªùi d√πng ƒë√£ h·ªßy h√†nh ƒë·ªông.");
                  }
              });
          } catch (e) {
              handleFunctionError("H√†m ch√≠nh saveData", e);
          }
      }

      function clearTable(table) {
        while (table.firstChild) {
          table.removeChild(table.firstChild);
        }
      }
      // H√†m ch·ªânh s·ª≠a b√°o s·ª≠a
      let iduserdv;
      function editreport(id) {
        id_sc = id
        try {
          // G·ªçi Apps Script ƒë·ªÉ l·∫•y d·ªØ li·ªáu t∆∞∆°ng ·ª©ng v·ªõi ID
          google.script.run.withSuccessHandler((data) => {
            try {
              if (data && Object.keys(data).length > 0) { // Ki·ªÉm tra d·ªØ li·ªáu h·ª£p l·ªá
                status_sc = data[mycol.DataSC.trangthai]
                document.getElementById("dialogTitle").textContent = `Ch·ªânh s·ª≠a b√°o h·ªèng: ${data[mycol.DataSC.id]}`;
                //Hi·ªán/·∫©n c√°c ƒë·ªëi t∆∞·ª£ng accordi
                update_trangthai(data[mycol.DataSC.trangthai]);

                iduserdv =  data[mycol.DataSC.iduserdv]
                const rowsnguoiyeucau= mydata.val_DSUserDV.filter(item => item[mycol.DSUserDV.id] === iduserdv);   
                if (rowsnguoiyeucau.length === 0) {
                    showwarning("Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi y√™u c·∫ßu v·ªõi id: " + iduserdv);
                    return; // Ho·∫∑c x·ª≠ l√Ω logic kh√°c n·∫øu c·∫ßn
                } 
                const rownguoiyeucau = rowsnguoiyeucau[0]
                document.getElementById("txt_donviyeucau_nguoiyeucau").value = rownguoiyeucau[mycol.DSUserDV.hoten]
                document.getElementById("txt_donviyeucau_sdt").value = rownguoiyeucau[mycol.DSUserDV.sdt]
                document.getElementById("txt_donviyeucau_donvi").value = rownguoiyeucau[mycol.DSUserDV.donvi]


                var idthietbi =  data[mycol.DataSC.idthietbi]
                const rowsthietbi = mydata.val_dsthietbi.filter(item => item[mycol.DSThietBi.id] === idthietbi); 
                if (rowsthietbi.length === 0) {
                    showwarning("Kh√¥ng t√¨m th·∫•y thi·∫øt b·ªã v·ªõi id: " + idthietbi);
                    return; // Ho·∫∑c x·ª≠ l√Ω logic kh√°c n·∫øu c·∫ßn
                }
                const rowthietbi = rowsthietbi[0] ;
                //Th√¥ng tin thi·∫øt b·ªã 
                document.getElementById("txt_tb_nhom").value = rowthietbi[mycol.DSThietBi.nhomtb]
                document.getElementById("txt_tb_id").value = rowthietbi[mycol.DSThietBi.id]
                document.getElementById("txt_tb_ten").value = rowthietbi[mycol.DSThietBi.tentb]
                document.getElementById("txt_tb_model").value = rowthietbi[mycol.DSThietBi.model]
                document.getElementById("txt_tb_serial").value = rowthietbi[mycol.DSThietBi.serial]
                document.getElementById("txt_tb_hang").value = rowthietbi[mycol.DSThietBi.hangsx]
                document.getElementById("txt_tb_namsx").value = rowthietbi[mycol.DSThietBi.namsx]
                document.getElementById("txt_tb_namsd").value =formatDateToDDMMYYYY( rowthietbi[mycol.DSThietBi.namsd])
                document.getElementById("txt_tb_hanbaohanh").value = rowthietbi[mycol.DSThietBi.hanbaohanh]
                document.getElementById("txt_tb_vitridat").value = rowthietbi[mycol.DSThietBi.vitridat]
                //G√°n d·ªØ li·ªáu 

                document.getElementById("txt_tinhtrangthietbiks").value = data[mycol.DataSC.tinhtrangthietbiks]
                document.getElementById("txt_ketluankhaosat").value = data[mycol.DataSC.ketluankhaosat]
                document.getElementById("txt_tinhtrang_dexuatphuongan").value = data[mycol.DataSC.dexuatphuongan]
                document.getElementById("txt_tinhtrang_bv1_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv1_daidien]
                document.getElementById("txt_tinhtrang_bv1_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv1_chucvu]
                document.getElementById("txt_tinhtrang_bv2_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv2_daidien]
                document.getElementById("txt_tinhtrang_bv2_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv2_chucvu]
                document.getElementById("txt_tinhtrang_bv3_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv3_daidien]
                document.getElementById("txt_tinhtrang_bv3_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv3_chucvu]
                document.getElementById("txt_tinhtrang_bv4_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv4_daidien]
                document.getElementById("txt_tinhtrang_bv4_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv4_chucvu]
                document.getElementById("txt_tinhtrang_bv5_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv5_daidien]
                document.getElementById("txt_tinhtrang_bv5_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv5_chucvu]
                document.getElementById("txt_tinhtrang_dv1_daidien").value = rownguoiyeucau[mycol.DSUserDV.dv1_daidien]
                document.getElementById("txt_tinhtrang_dv1_chucvu").value = rownguoiyeucau[mycol.DSUserDV.dv1_chucvu]
                document.getElementById("txt_tinhtrang_dv2_daidien").value = rownguoiyeucau[mycol.DSUserDV.dv2_daidien]
                document.getElementById("txt_tinhtrang_dv2_chucvu").value = rownguoiyeucau[mycol.DSUserDV.dv2_chucvu]

                document.getElementById("txt_tinhtrang_quyetdinhks").value = rownguoiyeucau[mycol.DSUserDV.quyetdinhtokhaosat]

                document.getElementById("txt_tinhtrang_ghichu").value = data[mycol.DataSC.ghichu]
                document.getElementById("txt_denghi_ghichu").value = data[mycol.DataSC.ghichu]
                document.getElementById("txt_bangiao_ghichu").value = data[mycol.DataSC.ghichu]
                document.getElementById("txt_denghi_noidung").value = data[mycol.DataSC.noidungdenghi]
                //B√†n giao

                document.getElementById("txt_bangiao_bv1_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv1_daidien]
                document.getElementById("txt_bangiao_bv1_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv1_chucvu]
                document.getElementById("txt_bangiao_bv2_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv2_daidien]
                document.getElementById("txt_bangiao_bv2_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv2_chucvu]
                document.getElementById("txt_bangiao_bv3_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv3_daidien]
                document.getElementById("txt_bangiao_bv3_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv3_chucvu]
                document.getElementById("txt_bangiao_bv4_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv4_daidien]
                document.getElementById("txt_bangiao_bv4_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv4_chucvu]
                document.getElementById("txt_bangiao_bv5_daidien").value = rownguoiyeucau[mycol.DSUserDV.bv5_daidien]
                document.getElementById("txt_bangiao_bv5_chucvu").value = rownguoiyeucau[mycol.DSUserDV.bv5_chucvu]
                document.getElementById("txt_bangiao_dv1_daidien").value = rownguoiyeucau[mycol.DSUserDV.dv1_daidien]
                document.getElementById("txt_bangiao_dv1_chucvu").value = rownguoiyeucau[mycol.DSUserDV.dv1_chucvu]
                document.getElementById("txt_bangiao_dv2_daidien").value = rownguoiyeucau[mycol.DSUserDV.dv2_daidien]
                document.getElementById("txt_bangiao_dv2_chucvu").value = rownguoiyeucau[mycol.DSUserDV.dv2_chucvu]
                switch (status_sc) {
                  case 1: // N·∫øu status_sc === 1
                    document.getElementById("txt_tinhtrang_ngayks").value = getCurrentDateFormatted();
                    break;
                  case 2: // N·∫øu status_sc === 2
                    document.getElementById("txt_tinhtrang_ngayks").value = data[mycol.DataSC.ngaykhaosat]; 
                    document.getElementById("txt_ngaydenghi").value = getCurrentDateFormatted();
                    document.getElementById("txt_ngaybangiao").value = getCurrentDateFormatted();
                    break;

                  case 3: // N·∫øu status_sc === 3
                    document.getElementById("txt_tinhtrang_ngayks").value = data[mycol.DataSC.ngaykhaosat]; 
                    document.getElementById("txt_ngaydenghi").value = data[mycol.DataSC.ngaydenghi]; 
                    document.getElementById("txt_ngaybangiao").value = getCurrentDateFormatted
                    break;
                  case 4: // N·∫øu status_sc === 4
                    document.getElementById("txt_tinhtrang_ngayks").value = data[mycol.DataSC.ngaykhaosat]; 
                    document.getElementById("txt_ngaydenghi").value = data[mycol.DataSC.ngaydenghi]; 
                    document.getElementById("txt_ngaybangiao").value = getCurrentDateFormatted
                    break;
                  default: // N·∫øu kh√¥ng kh·ªõp v·ªõi b·∫•t k·ª≥ case n√†o
                    console.log("Tr·∫°ng th√°i kh√¥ng x√°c ƒë·ªãnh");
                    break;
                }                  
                //T√¨nh tr·∫°ng thi·∫øt b·ªã b√†n giao
                document.getElementById("editDialog").style.display = "block";
                document.getElementById("overlay").style.display = "block";
              } else {
                showwarning("Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu cho ID n√†y.");
              }
            } catch (innerErr) {
              console.error("L·ªói trong qu√° tr√¨nh x·ª≠ l√Ω d·ªØ li·ªáu:", innerErr.message);
              showwarning("ƒê√£ x·∫£y ra l·ªói trong qu√° tr√¨nh x·ª≠ l√Ω d·ªØ li·ªáu: " + innerErr.message);
            }
          }).withFailureHandler((error) => {
            console.error("L·ªói t·ª´ Apps Script:", error);
            showwarning("C√≥ l·ªói x·∫£y ra khi g·ªçi Apps Script: " + error);
          }).SC_getDataById(id); // G·ªçi Apps Script v·ªõi ID
        } catch (err) {
          console.error("L·ªói khi th·ª±c thi editreport:", err.message);
          showwarning("ƒê√£ x·∫£y ra l·ªói trong qu√° tr√¨nh x·ª≠ l√Ω: " + err.message);
        }
      }

      function saveData() {
          try {
              if (status_sc >1 ){
                var cb_trangthai =  document.getElementById("cb_trangthai");
                if (cb_trangthai.value === "") {
                    showwarning("Vui l√≤ng ch·ªçn tr·∫°ng th√°i k·∫ø ti·∫øp.");
                    return false;
                }
                status_sc = cb_trangthai.value ;
              }

               showyesno("B·∫°n c√≥ mu·ªën ch·ªânh s·ª≠a v√† c·∫≠p nh·∫≠t d·ªØ li·ªáu cho m√£ s·ª≠a ch·ªØa c√≥ ID [" + id_sc + "] kh√¥ng?", "C·∫≠p nh·∫≠t d·ªØ li·ªáu").then((rs) => {
                  if (rs === 1) {
                      try {
                          showLoading();
                          closeDialog();
                          var inputdata = createInputData();
                          // console.log("Data ƒë·∫ßu v√†o: ", JSON.stringify(inputdata, null, 2));
                          google.script.run
                              .withSuccessHandler((result) => {
                                  try {
                                      mydata.val_DataSC = result;
                                      updatetable_all();  
                                      hideLoading();
                                      showwarning("ƒê√£ c·∫≠p nh·∫≠t th√†nh c√¥ng d·ªØ li·ªáu");
                                  } catch (e) {
                                      handleFunctionError("X·ª≠ l√Ω th√†nh c√¥ng", e);
                                  }
                              })
                              .withFailureHandler((error) => {
                                  console.error("L·ªói t·ª´ Apps Script:", error);
                                  alert("C√≥ l·ªói x·∫£y ra khi g·ªçi Apps Script: " + error);
                                  hideLoading();
                              })
                              .SC_update_dangsua(inputdata);
                      } catch (e) {
                          handleFunctionError("Quy tr√¨nh l∆∞u d·ªØ li·ªáu", e);
                      }
                  } else {
                      console.log("Ng∆∞·ªùi d√πng ƒë√£ h·ªßy h√†nh ƒë·ªông.");
                  }
              });
          } catch (e) {
              handleFunctionError("H√†m ch√≠nh saveData", e);
          }
      }

      function createInputData() {
          try {
              if(status_sc ===1){
                status_sc = 1 
              } else {
                status_sc = document.getElementById("cb_trangthai").value;
              }
              console.log("Tr·∫°ng th√°i:"+ status_sc)
              return {
                  id: id_sc,
                  iduserdv: iduserdv,
                  status_sc:  status_sc , 
                  idusersua: id_user,
                  val_dsthietbi: mydata.val_dsthietbi,
                  val_DSUserDV: mydata.val_DSUserDV,
                  val_DSUserSua: mydata.val_DSUserSua,
                  tinhtrangthietbiks: getValueById("txt_tinhtrangthietbiks"),
                  ketluankhaosat: getValueById("txt_ketluankhaosat"),
                  dexuatphuongan: getValueById("txt_tinhtrang_dexuatphuongan"),
                  ghichu: getValueById("txt_tinhtrang_ghichu"),
                  ngaykhaosat: getValueById("txt_tinhtrang_ngayks"),
                  quyetdinhtokhaosat: getValueById("txt_tinhtrang_quyetdinhks"),
                  bv1_daidien: getValueById("txt_tinhtrang_bv1_daidien"),
                  bv1_chucvu: getValueById("txt_tinhtrang_bv1_chucvu"),
                  bv2_daidien: getValueById("txt_tinhtrang_bv2_daidien"),
                  bv2_chucvu: getValueById("txt_tinhtrang_bv2_chucvu"),
                  bv3_daidien: getValueById("txt_tinhtrang_bv3_daidien"),
                  bv3_chucvu: getValueById("txt_tinhtrang_bv3_chucvu"),
                  bv4_daidien: getValueById("txt_tinhtrang_bv4_daidien"),
                  bv4_chucvu: getValueById("txt_tinhtrang_bv4_chucvu"),
                  bv5_daidien: getValueById("txt_tinhtrang_bv5_daidien"),
                  bv5_chucvu: getValueById("txt_tinhtrang_bv5_chucvu"),
                  dv1_daidien: getValueById("txt_tinhtrang_dv1_daidien"),
                  dv1_chucvu: getValueById("txt_tinhtrang_dv1_chucvu"),
                  dv2_daidien: getValueById("txt_tinhtrang_dv2_daidien"),
                  dv2_chucvu: getValueById("txt_tinhtrang_dv2_chucvu"),
                  ngaybangiao: getValueById("txt_ngaybangiao"),
                  // ngaybangiao: getValueById("txt_ngaybangiao"),
                  // tinhtrangbangiao: getValueById("txt_tinhtrangbangiao")
              };
          } catch (e) {
              handleFunctionError("T·∫°o d·ªØ li·ªáu ƒë·∫ßu v√†o", e);
          }
      }

      function getValueById(id) {
          try {
              const el = document.getElementById(id);
              if (!el) throw new Error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ v·ªõi ID: " + id);
              return el.value;
          } catch (e) {
              handleFunctionError(`L·∫•y gi√° tr·ªã t·ª´ ID: ${id}`, e);
          }
      }



      function handleFunctionError(context, error) {
          console.error(`L·ªói trong ${context}:`, error);
          alert(`ƒê√£ x·∫£y ra l·ªói trong ${context}. Chi ti·∫øt: ${error.message}`);
      }

      
      function formatDateToDDMMYYYY(rawDate) {
        if (!rawDate) return rawDate ; // Tr·∫£ v·ªÅ r·ªóng n·∫øu kh√¥ng c√≥ gi√° tr·ªã
        const date = new Date(rawDate);
        return date.toLocaleDateString("vi-VN", { day: "2-digit", month: "2-digit", year: "numeric" });
      }
      function closeDialog() {
        document.getElementById("editDialog").style.display = "none";
        document.getElementById("overlay").style.display = "none";
      }

      function toggleAccordion(index) {
        const panels = $(".panel");
        const icons = $(".accordion i");
        // L·∫•y panel v√† icon c·ªßa accordion ƒë∆∞·ª£c ch·ªçn
        const panel = $(panels[index]);
        const icon = panels.eq(index).prev().find("i");
        // N·∫øu accordion ƒëang m·ªü, ch·ªâ c·∫ßn ·∫©n n√≥ v√† c·∫≠p nh·∫≠t icon
        if (panel.is(":visible")) {
          panel.hide();
          icon.removeClass("fa-chevron-up").addClass("fa-chevron-down");
        } else {
          // ·∫®n t·∫•t c·∫£ c√°c accordion kh√°c v√† ƒë·∫∑t l·∫°i icon
          panels.hide();
          icons.removeClass("fa-chevron-up").addClass("fa-chevron-down");
          // Hi·ªÉn th·ªã accordion ƒë∆∞·ª£c ch·ªçn v√† c·∫≠p nh·∫≠t icon
          panel.show();
          icon.removeClass("fa-chevron-down").addClass("fa-chevron-up");
        }
      }


      // H√†m x√≥a b√°o s·ª≠a
      function deleteReport(id, btn) {
        showyesno("B·∫°n c√≥ mu·ªën x√≥a d·ªØ li·ªáu s·ª≠a ch·ªØa c√≥ ID " + id + " kh√¥ng?", "X√≥a d·ªØ li·ªáu").then((rs) => {
          if (rs === 1) {
            google.script.run.withSuccessHandler((result) => {
              if (result === true) {
                // X√≥a d√≤ng trong b·∫£ng HTML
                const row = btn.closest("tr");
                const table = row.closest("table");
                if (!table) {
                  console.error("Kh√¥ng t√¨m th·∫•y b·∫£ng ch·ª©a d√≤ng c·∫ßn x√≥a.");
                  return;
                }
                row.remove(); // X√≥a d√≤ng
                // ƒê√°nh l·∫°i s·ªë th·ª© t·ª±
                const rows = table.querySelectorAll("tbody tr"); // L·∫•y t·∫•t c·∫£ c√°c d√≤ng c√≤n l·∫°i trong b·∫£ng
                rows.forEach((tr, index) => {
                  const sttCell = tr.querySelector("td:first-child"); // L·∫•y √¥ STT (c·ªôt 1)
                  if (sttCell) {
                    sttCell.textContent = index + 1; // C·∫≠p nh·∫≠t STT (b·∫Øt ƒë·∫ßu t·ª´ 1)
                  }
                });
                // C·∫≠p nh·∫≠t l·∫°i s·ªë l∆∞·ª£ng cho tab t∆∞∆°ng ·ª©ng
                const tableId = table.id;
                let count = rows.length;
                if (tableId === "history_baohong") {
                  document.getElementById('tab-baohong').textContent = `B√°o h·ªèng (${count})`;
                } else if (tableId === "history_dangsua") {
                  document.getElementById('tab-dangsua').textContent = `ƒêang s·ª≠a (${count})`;
                } else if (tableId === "history_baohanh") {
                  document.getElementById('tab-baohanh').textContent = `B·∫£o h√†nh (${count})`;
                } else if (tableId === "history_suangoai") {
                  document.getElementById('tab-suangoai').textContent = `S·ª≠a ngo√†i (${count})`;
                }
              } else {
                alert("Kh√¥ng th·ªÉ x√≥a d√≤ng. ƒê√£ c√≥ l·ªói x·∫£y ra.");
              }
            }).withFailureHandler((error) => {
              alert("C√≥ l·ªói x·∫£y ra khi g·ªçi Apps Script: " + error);
            }).SC_delete(id); // G·ªçi h√†m Apps Script
          }
        });
      }
      //H√ÄM M·ªû PDF V·∫¨T T∆Ø THI·∫æT B·ªä 09
      function open_pdf_0901(idsc) {
        const result = mydata.val_DataSC.find(row => row[mycol.DataSC.id] === idsc);
      }

      function open_word_0901(idsc) {
        const result = mydata.val_DataSC.find(row => row[mycol.DataSC.id] === idsc);
      }
      //Ch·ªçn ng∆∞·ªùi s·ª≠a 
      function update_nguoisua(idnguoisua) {
        var cb_nguoisua = document.getElementById("cb_nguoisua")
        var selectedOption = cb_nguoisua.options[cb_nguoisua.selectedIndex];
        var phoneNumber = selectedOption.getAttribute("data-phone");
        document.getElementById("txt_sdt_nguoisua").value = phoneNumber; // C·∫≠p nh
      }
      //Update m√£ thi·∫øt b·ªã 
      function updateMaThietBi(selectedNhomThietBi) {
        // Duy·ªát qua c√°c thi·∫øt b·ªã v√† ch·ªâ ch·ªçn nh·ªØng thi·∫øt b·ªã thu·ªôc nh√≥m ƒë√£ ch·ªçn
        var comboBox = document.getElementById("cb_mathietbi");
        comboBox.innerHTML = ''; // X√≥a h·∫øt c√°c l·ª±a ch·ªçn trong comboBox
        // L·ªçc c√°c m√£ thi·∫øt b·ªã theo nh√≥m thi·∫øt b·ªã ƒë√£ ch·ªçn
        const filteredData = mydata.val_dsthietbi.filter(item => item[mycol.DSThietBi.nhomtb] === selectedNhomThietBi);
        // N·∫øu c√≥ thi·∫øt b·ªã thu·ªôc nh√≥m, th√™m v√†o dropdown
        if (filteredData.length > 0) {
          filteredData.forEach(function(value) {
            var option = document.createElement("option");
            option.text = "[" + value[mycol.DSThietBi.id] + "] " + value[mycol.DSThietBi.tentb]; // Gi·∫£ s·ª≠ m√£ thi·∫øt b·ªã l√† ·ªü c·ªôt 2 (index 1)
            option.value = value[mycol.DSThietBi.id]; // G√°n gi√° tr·ªã l√† m√£ thi·∫øt b·ªã
            comboBox.add(option);
          });
          // Sau khi th√™m thi·∫øt b·ªã v√†o dropdown, ch·ªçn thi·∫øt b·ªã ƒë·∫ßu ti√™n
          // comboBox.value = filteredData[0][mycol.DSThietBi.id]; // Ch·ªçn m√£ thi·∫øt b·ªã ƒë·∫ßu ti√™n
          // showDeviceDetails(comboBox.value);  // G·ªçi h√†m showDeviceDetails v·ªõi m√£ thi·∫øt b·ªã ƒë·∫ßu ti√™n
        }
      }
      //onchangeMaThietBi
      function showDeviceDetails(selectedMaThietBi) {
        // Ki·ªÉm tra n·∫øu kh√¥ng ch·ªçn m√£ thi·∫øt b·ªã
        if (!selectedMaThietBi) {
          return;
        }
        // T√¨m thi·∫øt b·ªã theo m√£ thi·∫øt b·ªã ƒë√£ ch·ªçn
        const selectedDevice = mydata.val_dsthietbi.find(item => item[mycol.DSThietBi.id] === selectedMaThietBi);
        // N·∫øu t√¨m th·∫•y thi·∫øt b·ªã, hi·ªÉn th·ªã th√¥ng tin v√†o c√°c textbox
        if (selectedDevice) {
          document.getElementById("txt_tb_ten").value = selectedDevice[mycol.DSThietBi.tentb];
          document.getElementById("txt_tb_model").value = selectedDevice[mycol.DSThietBi.model];
          document.getElementById("txt_tb_serial").value = selectedDevice[mycol.DSThietBi.serial];
          document.getElementById("txt_tb_hang").value = selectedDevice[mycol.DSThietBi.hangsx];
          document.getElementById("txt_tb_namsx").value = selectedDevice[mycol.DSThietBi.namsx];
          document.getElementById("txt_tb_namsd").value = selectedDevice[mycol.DSThietBi.namsd];
          document.getElementById("txt_tb_hanbaohanh").value = selectedDevice[mycol.DSThietBi.hanbaohanh];
          document.getElementById("txt_tb_vitridat").value = selectedDevice[mycol.DSThietBi.vitridat];
          // B·∫°n c√≥ th·ªÉ th√™m c√°c textbox kh√°c n·∫øu c√≥ th√™m th√¥ng tin t·ª´ c√°c c·ªôt kh√°c
        } else {
          // N·∫øu kh√¥ng t√¨m th·∫•y thi·∫øt b·ªã
          alert("Kh√¥ng t√¨m th·∫•y thi·∫øt b·ªã!");
        }
      }
      

      function login() {
        try {
          const username = document.getElementById("username").value.trim();
          const password = document.getElementById("password").value;
          if (!username || !password) {
            showwarning("Vui l√≤ng nh·∫≠p t√™n ƒëƒÉng nh·∫≠p v√† m·∫≠t kh·∫©u.");
            return;
          }
          const filteruser = mydata.val_DSUserSua.filter(item => item[mycol.DSUserSua.username].toLowerCase() === username.toLowerCase());
          if (filteruser.length > 0) {
            const user = filteruser[0];
            if (String(user[mycol.DSUserSua.pass]) === password) {
              id_user = user[mycol.DSUserSua.id].toLowerCase()
              // C·∫≠p nh·∫≠t th√¥ng tin ƒëƒÉng nh·∫≠p
              const userFields = {
                "txt_tendangnhap": user[mycol.DSUserSua.hoten],
                "txt_sdt_nguoisua": user[mycol.DSUserSua.sdt],
                "txt_donviquanly": user[mycol.DSUserSua.quanlydonvi],
                "txt_donvi": user[mycol.DSUserSua.donvi]
              };
              for (const [fieldId, value] of Object.entries(userFields)) {
                const field = document.getElementById(fieldId);
                if (field) {
                  field.value = value;
                } else {
                  console.warn(`Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ v·ªõi ID: ${fieldId}`);
                }
              }
              updatetable_all();
              // Hi·ªÉn th·ªã giao di·ªán dashboard
              document.getElementById("loginSection").style.display = "none";
              document.getElementById("dashboardSection").style.display = "block";
              document.getElementById("WebUI_BaoSua").style.display = "block";
              document.querySelector('.container').classList.add('full-screen-container');
            } else {
              showwarning("M·∫≠t kh·∫©u ƒëƒÉng nh·∫≠p kh√¥ng ch√≠nh x√°c.");
            }
          } else {
            showwarning("Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi d√πng n√†o ph√π h·ª£p.");
          }
        } catch (error) {
          showwarning(`ƒê√£ x·∫£y ra l·ªói: ${error.message}`);
          console.error(error); // Ghi l·ªói v√†o console ƒë·ªÉ d·ªÖ ki·ªÉm tra
        }
      }

      function togglePassword() {
        const passwordInput = document.getElementById("password");
        const toggleIcon = document.getElementById("togglePasswordIcon");
        if (passwordInput.type === "password") {
          passwordInput.type = "text";
          toggleIcon.classList.remove("bi-eye");
          toggleIcon.classList.add("bi-eye-slash");
        } else {
          passwordInput.type = "password";
          toggleIcon.classList.remove("bi-eye-slash");
          toggleIcon.classList.add("bi-eye");
        }
      }

      function showTab(sectionId, tabElement, event) {
        // NgƒÉn tr√¨nh duy·ªát ƒëi·ªÅu h∆∞·ªõng khi nh·∫•n v√†o li√™n k·∫øt
        if (event) event.preventDefault();
        // ·∫®n t·∫•t c·∫£ c√°c tab n·ªôi dung
        document.querySelectorAll('.tab').forEach(section => {
          section.style.display = 'none';
        });
        // Hi·ªÉn th·ªã tab ƒë∆∞·ª£c ch·ªçn
        document.getElementById(sectionId).style.display = 'block';
        // X√≥a l·ªõp 'active' kh·ªèi t·∫•t c·∫£ c√°c tab
        document.querySelectorAll('.nav-link').forEach(tab => {
          tab.classList.remove('active');
        });
        // Th√™m l·ªõp 'active' v√†o tab hi·ªán t·∫°i
        tabElement.classList.add('active');
      }
      // Hi·ªÉn th·ªã modal "ƒê·ªïi m·∫≠t kh·∫©u"
      function showPasswordResetModal() {
        document.getElementById('passwordResetModal').style.display = 'block';
      }
      // ƒê√≥ng modal "ƒê·ªïi m·∫≠t kh·∫©u"
      function closePasswordResetModal() {
        document.getElementById('passwordResetModal').style.display = 'none';
      }

      function saveNewPassword() {
        var tendangnhap = document.getElementById('txt_username1').value;
        if (tendangnhap === "") {
          showwarning('B·∫°n vui l√≤ng nh·∫≠p t√™n ƒëƒÉng nh·∫≠p');
          return;
        }
        var oldPassword = document.getElementById('oldPassword').value;
        if (oldPassword === "") {
          showwarning('B·∫°n vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u c≈©');
          return;
        }
        var newPassword = document.getElementById('newPassword').value;
        if (newPassword === "") {
          showwarning('B·∫°n vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u m·ªõi');
          return;
        }
        var confirmPassword = document.getElementById('confirmPassword').value;
        if (confirmPassword === "") {
          showwarning('B·∫°n vui l√≤ng nh·∫≠p x√°c nh·∫≠n l·∫°i m·∫≠t kh·∫©u m·ªõi');
          return;
        }
        // Ki·ªÉm tra t√≠nh h·ª£p l·ªá
        if (newPassword !== confirmPassword) {
          showwarning('M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp.');
          return;
        }
        const filteruser = mydata.val_DSUserDV.filter(item => item[mycol.DSUserDV.username] === tendangnhap);
        if (filteruser.length > 0) {
          var user = filteruser[0]
          if (String(user[mycol.DSUserDV.pass]) === oldPassword) {
            var iduser = user[mycol.DSUserDV.id]
            // G·ª≠i y√™u c·∫ßu t·ªõi Apps Script
            google.script.run.withSuccessHandler(function(response) {
              if (response === true) {
                showinfor('M·∫≠t kh·∫©u ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t.');
              } else {
                showwarning('C·∫≠p nh·∫≠t m·∫≠t kh·∫©u th·∫•t b·∫°i.');
              }
            }).withFailureHandler(function(error) {
              showerror('C√≥ l·ªói x·∫£y ra: ' + error.message);
            }).usersua_update_password(iduser, newPassword); // Truy·ªÅn userID v√† newPassword v√†o h√†m
          } else {
            showwarning("M·∫≠t kh·∫©u ƒëƒÉng nh·∫≠p kh√¥ng ch√≠nh x√°c");
            return;
          }
        } else {
          showwarning("Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi d√πng n√†o ph√π h·ª£p");
          return;
        }
      }
      // H√†m hi·ªÉn th·ªã/·∫©n m·∫≠t kh·∫©u
      function togglePassword() {
        var passwordField = document.getElementById('password');
        var toggleIcon = document.getElementById('togglePasswordIcon');
        if (passwordField.type === "password") {
          passwordField.type = "text";
          toggleIcon.classList.remove("fa-eye");
          toggleIcon.classList.add("fa-eye-slash");
        } else {
          passwordField.type = "password";
          toggleIcon.classList.remove("fa-eye-slash");
          toggleIcon.classList.add("fa-eye");
        }
      }
      // H√†m hi·ªÉn th·ªã/·∫©n m·∫≠t kh·∫©u c≈© trong modal
      function toggleOldPassword() {
        var oldPasswordField = document.getElementById('oldPassword');
        var toggleIcon = document.getElementById('toggleOldPasswordIcon');
        if (oldPasswordField.type === "password") {
          oldPasswordField.type = "text";
          toggleIcon.classList.remove("fa-eye");
          toggleIcon.classList.add("fa-eye-slash");
        } else {
          oldPasswordField.type = "password";
          toggleIcon.classList.remove("fa-eye-slash");
          toggleIcon.classList.add("fa-eye");
        }
      }
      // H√†m hi·ªÉn th·ªã/·∫©n m·∫≠t kh·∫©u m·ªõi trong modal
      function toggleNewPassword() {
        var newPasswordField = document.getElementById('newPassword');
        var toggleIcon = document.getElementById('toggleNewPasswordIcon');
        if (newPasswordField.type === "password") {
          newPasswordField.type = "text";
          toggleIcon.classList.remove("fa-eye");
          toggleIcon.classList.add("fa-eye-slash");
        } else {
          newPasswordField.type = "password";
          toggleIcon.classList.remove("fa-eye-slash");
          toggleIcon.classList.add("fa-eye");
        }
      }
      // H√†m hi·ªÉn th·ªã/·∫©n x√°c nh·∫≠n m·∫≠t kh·∫©u trong modal
      function toggleConfirmPassword() {
        var confirmPasswordField = document.getElementById('confirmPassword');
        var toggleIcon = document.getElementById('toggleConfirmPasswordIcon');
        if (confirmPasswordField.type === "password") {
          confirmPasswordField.type = "text";
          toggleIcon.classList.remove("fa-eye");
          toggleIcon.classList.add("fa-eye-slash");
        } else {
          confirmPasswordField.type = "password";
          toggleIcon.classList.remove("fa-eye-slash");
          toggleIcon.classList.add("fa-eye");
        }
      }
    </script>
  </head>
  <body>
    <!-- N·∫†P D·ªÆ LI·ªÜU -->
    <div class="loading-screen" id="loading">
      <div class="spinner"></div>
      <div class="loading-message">ƒêang n·∫°p d·ªØ li·ªáu, b·∫°n vui l√≤ng ƒë·ª£i trong gi√¢y l√°t nh√©</div>
    </div>
    <!-- ƒêƒÇNG NH·∫¨P -->
    <div class="container">
      <div id="loginSection" class="section" style="display: block;">
        <div class="card">
          <div class="card-header">ƒêƒÉng nh·∫≠p</div>
          <div class="card-body">
            <div class="mb-3">
              <label for="username" class="form-label">T√™n ƒëƒÉng nh·∫≠p</label>
              <div class="input-group">
                <span class="input-group-text">
                  <i class="fas fa-user"></i>
                </span>
                <input type="text" class="form-control" id="username" required>
              </div>
            </div>
            <div class="mb-3 password-field">
              <label for="password" class="form-label">M·∫≠t kh·∫©u</label>
              <div class="input-group">
                <span class="input-group-text">
                  <i class="fas fa-lock"></i>
                </span>
                <input type="password" class="form-control" id="password" required>
                <span class="input-group-text" onclick="togglePassword()">
                  <i id="togglePasswordIcon" class="fas fa-eye toggle-password"></i>
                </span>
              </div>
            </div>
            <!-- ƒê·ªïi m·∫≠t kh·∫©u -->
            <div class="mb-3 text-center">
              <a href="javascript:void(0);" onclick="showPasswordResetModal()">ƒê·ªïi m·∫≠t kh·∫©u?</a>
            </div>
            <button class="btn btn-primary w-100" onclick="login()">ƒêƒÉng nh·∫≠p</button>
          </div>
        </div>
      </div>
      <!-- Modal ƒê·ªïi m·∫≠t kh·∫©u -->
      <div id="passwordResetModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="passwordResetModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="passwordResetModalLabel">C·∫≠p nh·∫≠t m·∫≠t kh·∫©u</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closePasswordResetModal()">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="mb-3">
                <label for="username" class="form-label">T√™n ƒëƒÉng nh·∫≠p</label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-user"></i>
                  </span>
                  <input type="text" class="form-control" id="txt_username1" required>
                </div>
              </div>
              <div class="mb-3">
                <label for="oldPassword" class="form-label">M·∫≠t kh·∫©u c≈©</label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-lock"></i>
                  </span>
                  <input type="password" class="form-control" id="oldPassword" required>
                  <span class="input-group-text" onclick="toggleOldPassword()">
                    <i id="toggleOldPasswordIcon" class="fas fa-eye toggle-password"></i>
                  </span>
                </div>
              </div>
              <div class="mb-3">
                <label for="newPassword" class="form-label">M·∫≠t kh·∫©u m·ªõi</label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-lock"></i>
                  </span>
                  <input type="password" class="form-control" id="newPassword" required>
                  <span class="input-group-text" onclick="toggleNewPassword()">
                    <i id="toggleNewPasswordIcon" class="fas fa-eye toggle-password"></i>
                  </span>
                </div>
              </div>
              <div class="mb-3">
                <label for="confirmPassword" class="form-label">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-lock"></i>
                  </span>
                  <input type="password" class="form-control" id="confirmPassword" required>
                  <span class="input-group-text" onclick="toggleConfirmPassword()">
                    <i id="toggleConfirmPasswordIcon" class="fas fa-eye toggle-password"></i>
                  </span>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" onclick="closePasswordResetModal()">H·ªßy b·ªè</button>
              <button type="button" class="btn btn-primary" onclick="saveNewPassword()">L∆∞u</button>
            </div>
          </div>
        </div>
      </div>
      <div id="dashboardSection" class="dashboard" style="display: none;">
        <div class="card">
          <div id="WebUI_BaoSua" class="section" style="display: block;">
            <h5>TH√îNG TIN NG∆Ø·ªúI S·ª¨A</h5>
            <div class="mb-3 row">
              <label for="tendangnhap" class="col-sm-2 col-form-label">H·ªç v√† t√™n</label>
              <div class="col-sm-5">
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-user"></i>
                  </span>
                  <input type="text" class="form-control"  id="txt_tendangnhap" readonly  >
                </div>
              </div>
              <div class="col-sm-5">
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-building"></i>
                  </span>
                  <input type="text" class="form-control" id="txt_donvi" readonly>
                </div>
              </div>
            </div>
            <div class="mb-3 row"  style="display: none;" >
              <label for="ho_ten_yeucau" class="col-sm-2 col-form-label">ƒê∆°n v·ªã qu·∫£n l√Ω</label>
              <div class="col-sm-5">
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-user"></i>
                  </span>
                  <input type="text" class="form-control" id="txt_donviquanly" readonly>
                </div>
              </div>
              <div class="col-sm-5">
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-phone"></i>
                  </span>
                  <input type="text" class="form-control" id="txt_sdt_nguoisua"  readonly >
                </div>
              </div>
            </div>
          </div>
          <!-- Modal ch·ª©a spinner -->
          <div id="loadingModal" class="modal">
            <div class="modal-content">
              <div class="spinner"></div>
              <div class="loading-text">ƒêang t√≠nh to√°n v√† l∆∞u d·ªØ li·ªáu, b·∫°n ƒë·ª£i gi√¢y l√°t nh√©...</div>
            </div>
          </div>
          <!-- V·ªä TR√ç LOAD TH√îNG TIN CH·ªàNH S·ª≠a -->
          <div id="editDialog">
            <div class="dialog-header" id="dialogTitle">Ch·ªânh s·ª≠a th√¥ng tin</div>
            <div class="dialog-body">
              <div id="accordionContainer">
                <div class="accordion" id="accordion1" onclick="toggleAccordion(0)"> TH√îNG TIN ƒê∆†N V·ªä Y√äU C·∫¶U <i class="fa fa-chevron-down"></i>
                </div>
                <div id= "panel1"  class="panel">
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="nguoiyeucau" class="form-label">Ng∆∞·ªùi y√™u c·∫ßu</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_donviyeucau_nguoiyeucau" readonly>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="sodienthoainguoiyeucau" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_donviyeucau_sdt" readonly>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-15">
                    <label for="donvi" class="col-sm-2 col-form-label">ƒê∆°n v·ªã</label>
                    <div class="input-group">
                      <span class="input-group-text">
                        <i class="fas fa-building"></i>
                      </span>
                      <input type="text" class="form-control" id="txt_donviyeucau_donvi" readonly>
                    </div>
                  </div>
                </div>
                <div class="accordion" id="accordion2" onclick="toggleAccordion(1)"> TH√îNG TIN THI·∫æT B·ªä <i class="fa fa-chevron-down"></i>
                </div>
                <div  id= "panel2" class="panel">
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="tenThietBi" class="form-label">Nh√≥m thi·∫øt b·ªã</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-th-large"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_nhom" readonly>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="model" class="form-label">M√£ thi·∫øt b·ªã</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-barcode"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_id" readonly>
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="tenThietBi" class="form-label">T√™n thi·∫øt b·ªã</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-cogs"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_ten" readonly>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="model" class="form-label">Model</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_model" readonly>
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="serial" class="form-label">Serial</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-barcode"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_serial" readonly>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="hangSanXuat" class="form-label">H√£ng s·∫£n xu·∫•t</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-industry"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_hang" readonly>
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="namSanXuat" class="form-label">NƒÉm s·∫£n xu·∫•t</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-calendar-alt"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_namsx" readonly>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="namSuDung" class="form-label">NƒÉm ƒë∆∞a v√†o s·ª≠ d·ª•ng</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-calendar-check"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_namsd" readonly>
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="hanBaoHanh" class="form-label">H·∫°n b·∫£o h√†nh</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-shield-alt"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_hanbaohanh" readonly>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="viTriDat" class="form-label">V·ªã tr√≠ ƒë·∫∑t</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-map-marker-alt"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tb_vitridat" readonly>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="accordion" id="accordion3" onclick="toggleAccordion(2)"> TH√îNG TIN T√åNH TR·∫†NG THI·∫æT B·ªä H·ªéNG <i class="fa fa-chevron-down"></i>
                </div>
                <div  id= "panel3" class="panel">
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="hanBaoHanh" class="form-label">T√¨nh tr·∫°ng thi·∫øt b·ªã</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-tools"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrangthietbiks" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="viTriDat" class="form-label">K·∫øt lu·∫≠n</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-clipboard-check"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_ketluankhaosat" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="hanBaoHanh" class="form-label">ƒê·ªÅ xu·∫•t ph∆∞∆°ng √°n s·ª≠a</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-wrench"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_dexuatphuongan" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="viTriDat" class="form-label">Ghi ch√∫</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-comment-dots"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_ghichu">
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv1" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 1</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv1_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu1" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv1_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv2" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 2</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv2_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu2" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv2_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv3" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 3</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv3_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu3" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv3_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv4" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 4</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv4_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu4" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv4_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv5" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 5</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv5_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu5" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_bv5_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidiendv1" class="form-label">ƒê·∫°i di·ªán ƒë∆°n v·ªã 1</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_dv1_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvudv1" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_dv1_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidiendv2" class="form-label">ƒê·∫°i di·ªán ƒë∆°n v·ªã 2</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_dv2_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvudv2" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_dv2_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="quyetdinhkhaosat" class="form-label">Quy·∫øt ƒë·ªãnh kh·∫£o s√°t</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-file-alt"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_quyetdinhks" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="ngaykhaosat" class="form-label">Ng√†y kh·∫£o s√°t</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-calendar-alt"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrang_ngayks" >
                      </div>
                    </div>
                  </div>
                </div>
                <div class="accordion" id="accordion4" onclick="toggleAccordion(3)"> ƒê·ªÄ NGH·ªä PH∆Ø∆†NG √ÅN S·ª¨A <i class="fa fa-chevron-down"></i>
                </div>
                <div  id= "panel4"  class="panel">
                  <div class="row align-items-center mt-3"  >
                    <div class="col-sm-12 d-flex align-items-center">
                      <label for="cb_trangthai" class="form-label" style="min-width: 150px;">Ch·ªçn tr·∫°ng th√°i b∆∞·ªõc ti·∫øp theo:</label>
                      <div class="input-group flex-grow-1">
                        <span class="input-group-text"><i class="fas fa-cogs"></i></span>
                        <select class="form-control" id="cb_trangthai">
                          <option value="">Vui l√≤ng ch·ªçn ph∆∞∆°ng √°n s·ª≠a</option>
                          <option value=2>ƒêang s·ª≠a</option>
                          <option value=3>B·∫£o h√†nh</option>
                          <option value=4>S·ª≠a ngo√†i</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="denghi_noidung" class="form-label">N·ªôi dung ƒë·ªÅ ngh·ªã</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-pencil-alt"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_denghi_noidung" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="denghi_ngay" class="form-label">Ng√†y ƒë·ªÅ ngh·ªã</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-calendar-alt"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_ngaydenghi"  readonly >
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-15">
                    <label for="denghi_ghichu" class="col-sm-2 col-form-label">Ghi ch√∫</label>
                    <div class="input-group">
                      <span class="input-group-text">
                        <i class="fas fa-comment-dots"></i>
                      </span>
                      <input type="text" class="form-control" id="txt_denghi_ghichu" >
                    </div>
                  </div>
                </div>
                <div class="accordion"  id="accordion5"  onclick="toggleAccordion(4)"> B√ÄN GIAO, NGHI·ªÜM THU ƒê∆ØA V√ÄO S·ª¨ D·ª§NG <i class="fa fa-chevron-down"></i>
                </div>
                <div id= "panel5"   class="panel">
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="bangiao_tinhtrang" class="form-label">T√¨nh tr·∫°ng thi·∫øt b·ªã sau khi s·ª≠a ch·ªØa</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-tools"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_tinhtrangbangiao" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="bangiao_ngay" class="form-label">Ng√†y b√†n giao</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-calendar-alt"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_ngaybangiao" readonly >
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-15">
                    <label for="bangiao_ghichu" class="col-sm-2 col-form-label">Ghi ch√∫</label>
                    <div class="input-group">
                      <span class="input-group-text">
                        <i class="fas fa-comment-dots"></i>
                      </span>
                      <input type="text" class="form-control" id="txt_bangiao_ghichu" >
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv1" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 1</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv1_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu1" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv1_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv2" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 2</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv2_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu2" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv2_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv3" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 3</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv3_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu3" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv3_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv4" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 4</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv4_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu4" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv4_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidienbv5" class="form-label">ƒê·∫°i di·ªán b·ªánh vi·ªán 5</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-md"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv5_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvu5" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_bv5_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidiendv1" class="form-label">ƒê·∫°i di·ªán ƒë∆°n v·ªã 1</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_dv1_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvudv1" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_dv1_chucvu" >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3 row">
                    <div class="col-sm-6">
                      <label for="daidiendv2" class="form-label">ƒê·∫°i di·ªán ƒë∆°n v·ªã 2</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_dv2_daidien" >
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <label for="chucvudv2" class="form-label">Ch·ª©c v·ª•</label>
                      <div class="input-group">
                        <span class="input-group-text">
                          <i class="fas fa-user-tag"></i>
                        </span>
                        <input type="text" class="form-control" id="txt_bangiao_dv2_chucvu" >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="dialog-footer">
              <button class="btnclose" onclick="closeDialog()">ƒê√≥ng </button>
              <button class="btn-save" onclick="saveData()">L∆∞u</button>
            </div>
          </div>
          <div class="overlay" id="overlay"></div>
          <H2></H2>
          <div id="WebUI_BaoSua" class="section" style="display: block;">
            <h5>L·ªäCH S·ª¨ B√ÅO S·ª¨A</h5>
            <div class="card-body">
              <!-- Tabs ƒëi·ªÅu h∆∞·ªõng ch√≠nh -->
              <ul class="nav nav-tabs">
                <li class="nav-item">
                  <a class="nav-link active" id="tab-baohong" onclick="showTab('WebUI_ds_baohong', this, event)" href="#">B√°o h·ªèng</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="tab-dangsua" onclick="showTab('WebUI_ds_dangsua', this, event)" href="#">ƒêang s·ª≠a</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="tab-baohanh" onclick="showTab('WebUI_ds_baohanh', this, event)" href="#">B·∫£o h√†nh</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="tab-suangoai" onclick="showTab('WebUI_ds_suangoai', this, event)" href="#">S·ª≠a ngo√†i</a>
                </li>
              </ul>
              <br>
              <!-- N·ªôi dung c·ªßa t·ª´ng tab -->
              <div id="WebUI_ds_baohong" class="tab" style="display: block;">
                <table id="table_baohong" class="custom-table">
                  <thead>
                    <tr class="tb_header">
                      <th>STT</th>
                      <th>N·ªôi dung</th>
                      <th>H√†nh ƒë·ªông</th>
                    </tr>
                  </thead>
                  <tbody id="history_baohong">
                    <!-- C√°c d√≤ng l·ªãch s·ª≠ b√°o s·ª≠a s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                  </tbody>
                </table>
              </div>
              <div id="WebUI_ds_dangsua" class="tab" style="display: none;">
                <table id="table_dangsua" class="custom-table">
                  <thead>
                    <tr class="tb_header">
                      <th>STT</th>
                      <th>N·ªôi dung</th>
                      <th>H√†nh ƒë·ªông</th>
                    </tr>
                  </thead>
                  <tbody id="history_dangsua">
                    <!-- C√°c d√≤ng l·ªãch s·ª≠ b√°o s·ª≠a s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                  </tbody>
                </table>
              </div>
              <div id="WebUI_ds_baohanh" class="tab" style="display: none;">
                <table id="table_baohanh" class="custom-table">
                  <thead>
                    <tr class="tb_header">
                      <th>STT</th>
                      <th>N·ªôi dung</th>
                      <th>H√†nh ƒë·ªông</th>
                    </tr>
                  </thead>
                  <tbody id="history_baohanh">
                    <!-- C√°c d√≤ng l·ªãch s·ª≠ b√°o s·ª≠a s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                  </tbody>
                </table>
              </div>
              <div id="WebUI_ds_suangoai" class="tab" style="display: none;">
                <table id="table_suangoai" class="custom-table">
                  <thead>
                    <tr class="tb_header">
                      <th>STT</th>
                      <th>N·ªôi dung</th>
                      <th>H√†nh ƒë·ªông</th>
                    </tr>
                  </thead>
                  <tbody id="history_suangoai">
                    <!-- C√°c d√≤ng l·ªãch s·ª≠ b√°o s·ª≠a s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
      <script>
        
        function showLoading() {
          document.getElementById('loadingModal').style.display = 'flex'; // Hi·ªÉn th·ªã modal
        }

        function hideLoading() {
          document.getElementById('loadingModal').style.display = 'none'; // ·∫®n modal
        }
        function getCurrentDateFormatted() {
          const today = new Date();
          const day = String(today.getDate()).padStart(2, '0'); // L·∫•y ng√†y, th√™m s·ªë 0 n·∫øu c·∫ßn
          const month = String(today.getMonth() + 1).padStart(2, '0'); // Th√°ng t√≠nh t·ª´ 0
          const year = today.getFullYear();
          return `${day}/${month}/${year}`;
        }

        // C·∫¨P NH·∫¨T HI·ªÜN/·∫®N THEO TR·∫†NG TH√ÅI
        function update_trangthai(selectedValue) {
          // L·∫•y t·∫•t c·∫£ c√°c accordion
          const accordionList = document.querySelectorAll(".accordion");

          // ·∫®n t·∫•t c·∫£ accordion
          accordionList.forEach(acc => {
            acc.style.display = "none";
          });

          // Hi·ªán accordion d·ª±a tr√™n gi√° tr·ªã tr·∫°ng th√°i
          try {
            switch (selectedValue) {
              case 1: // B√°o h·ªèng
                console.log("B√°o h·ªèng: " + selectedValue);
                showAccordions(["accordion1", "accordion2", "accordion3"]);
                setAccordionReadonly("panel1", true);
                setAccordionReadonly("panel2", true);
                setAccordionReadonly("panel3", false);
                break;

              case 2: // ƒêang s·ª≠a
                console.log("ƒêang s·ª≠a: " + selectedValue);
                showAccordions(["accordion1", "accordion2", "accordion3", "accordion4",  "accordion5"]);
                setAccordionReadonly("panel1", true);
                setAccordionReadonly("panel2", true);
                setAccordionReadonly("panel3", true);
                setAccordionReadonly("panel4", false);
                setAccordionReadonly("panel5", false);
                break;

              case 3: // B·∫£o h√†nh
                console.log("B·∫£o h√†nh: " + selectedValue);
                showAccordions(["accordion1", "accordion2", "accordion3", "accordion4",  "accordion5"]);
                setAccordionReadonly("panel1", true);
                setAccordionReadonly("panel2", true);
                setAccordionReadonly("panel3", true);
                setAccordionReadonly("panel4", true);
                setAccordionReadonly("panel5", false);
                break;

              case 4: // S·ª≠a ngo√†i
                console.log("S·ª≠a ngo√†i: " + selectedValue);
                showAccordions(["accordion1", "accordion2", "accordion3", "accordion4",  "accordion5"]);
                setAccordionReadonly("panel1", true);
                setAccordionReadonly("panel2", true);
                setAccordionReadonly("panel3", true);
                setAccordionReadonly("panel4", true);
                setAccordionReadonly("panel5", false);
                break;

              default:
                console.warn("Tr·∫°ng th√°i kh√¥ng h·ª£p l·ªá!");
                showwarning("L·ªói: Tr·∫°ng th√°i kh√¥ng h·ª£p l·ªá!");
            }
          } catch (error) {
            console.error("L·ªói khi c·∫≠p nh·∫≠t tr·∫°ng th√°i:", error.message);
            showwarning("ƒê√£ x·∫£y ra l·ªói: " + error.message);
          }
        }
        function showAccordions(accordionIds) {
          accordionIds.forEach(id => {
            const accordion = document.getElementById(id);
            if (accordion) {
              accordion.style.display = "block";
            } else {
              console.warn(`Accordion v·ªõi ID "${id}" kh√¥ng t·ªìn t·∫°i.`);
              alert(`L·ªói: Accordion v·ªõi ID "${id}" kh√¥ng t·ªìn t·∫°i.`);
            }
          });
        }
        //Thi·∫øt ƒë·∫∑t tr·∫°ng th√°i c·ªßa c√°c textbox theo accordion;
        function setAccordionReadonly(accordionId, readonly) {
          // L·∫•y accordion d·ª±a tr√™n ID
          const accordion = document.getElementById(accordionId);
          if (!accordion) {
            console.warn(`L·ªói: Accordion v·ªõi ID "${accordionId}" kh√¥ng t·ªìn t·∫°i.`);
            alert(`L·ªói: Accordion v·ªõi ID "${accordionId}" kh√¥ng t·ªìn t·∫°i.`);
            return;
          }

          try {
            // T√¨m t·∫•t c·∫£ c√°c textbox b√™n trong accordion
            const textboxes = accordion.querySelectorAll("input[type='text']");

            if (textboxes.length === 0) {
              console.warn(`L·ªói: Kh√¥ng t√¨m th·∫•y textbox n√†o trong accordion v·ªõi ID "${accordionId}".`);
              alert(`L·ªói: Kh√¥ng t√¨m th·∫•y textbox n√†o trong accordion v·ªõi ID "${accordionId}".`);
              return;
            }

            // Thi·∫øt l·∫≠p tr·∫°ng th√°i readonly cho t·ª´ng textbox
            textboxes.forEach(textbox => {
              switch (textbox.id) {
                case "txt_tinhtrang_ngayks":
                  textbox.readOnly = true;                  break;

                case "txt_ngaydenghi":
                  textbox.readOnly = true;
                  break;
                case "txt_ngaybangiao":
                  textbox.readOnly = true;
                  break;
                default:
                  // C√°c textbox kh√°c theo gi√° tr·ªã truy·ªÅn v√†o
                  textbox.readOnly = readonly;
                  break;
              }
            });
          } catch (error) {
            console.error(`ƒê√£ x·∫£y ra l·ªói khi x·ª≠ l√Ω accordion ID "${accordionId}":`, error.message);
            alert(`ƒê√£ x·∫£y ra l·ªói khi x·ª≠ l√Ω accordion ID "${accordionId}": ${error.message}`);
          }
        }
        // N√∫t s·ª≠a
        function editMode(enable) {
          // Hi·ªÉn th·ªã ho·∫∑c ·∫©n c√°c n√∫t theo tr·∫°ng th√°i ch·ªânh s·ª≠a
          document.getElementById("bt_sc_new").style.display = enable ? "none" : "inline-block"; // ·∫®n n√∫t Th√™m
          document.getElementById("bt_sc_edit").style.display = enable ? "inline-block" : "none"; // Hi·ªán n√∫t C·∫≠p nh·∫≠t
          document.getElementById("bt_sc_close").style.display = enable ? "inline-block" : "none"; // Hi·ªán n√∫t Tho√°t
        }
        //c·∫≠p nh·∫≠t 
       

        //Ch·∫ø ƒë·ªô edit mod
        function exitEditMode() {
          editMode(false); // Tho√°t ch·∫ø ƒë·ªô ch·ªânh s·ª≠a
        }

        function fetchDeviceInfo() {
          const maThietBi = document.getElementById("maThietBi").value;
          if (maThietBi === "TB001") {
            document.getElementById("tenThietBi").value = "M√°y X-Quang";
            document.getElementById("model").value = "Model A1";
            document.getElementById("serial").value = "SN12345";
            document.getElementById("hangSanXuat").value = "H√£ng XYZ";
            document.getElementById("namSanXuat").value = "2020";
            document.getElementById("namSuDung").value = "2021";
            document.getElementById("hanBaoHanh").value = "2025";
            document.getElementById("viTriDat").value = "Ph√≤ng A";
          } else {
            document.getElementById("tenThietBi").value = "";
            document.getElementById("model").value = "";
            document.getElementById("serial").value = "";
            document.getElementById("hangSanXuat").value = "";
            document.getElementById("namSanXuat").value = "";
            document.getElementById("namSuDung").value = "";
            document.getElementById("hanBaoHanh").value = "";
            document.getElementById("viTriDat").value = "";
          }
        }
        //H√†m hi·ªÉn th·ªã th√¥ng b√°o message box 
        function showerror(message) {
          Swal.fire({
            icon: 'error',
            title: 'Th√¥ng b√°o',
            text: message,
            confirmButtonText: 'ƒê·ªìng √Ω',
          });
        }

        function showwarning(message) {
          Swal.fire({
            icon: 'warning',
            title: 'Th√¥ng b√°o',
            text: message,
            confirmButtonText: 'ƒê·ªìng √Ω',
          });
        }

        function showinfor(message) {
          Swal.fire({
            icon: 'info',
            title: 'Th√¥ng b√°o',
            text: message,
            confirmButtonText: 'ƒê·ªìng √Ω',
          });
        }

        function showsucces(message) {
          Swal.fire({
            icon: 'success',
            title: 'Th√¥ng b√°o',
            text: message,
            confirmButtonText: 'ƒê·ªìng √Ω',
          });
        }

        function showyesno(message, title) {
          return Swal.fire({
            title: title,
            text: message,
            icon: 'question',
            showCancelButton: true,
            confirmButtonText: 'C√≥',
            cancelButtonText: 'Kh√¥ng',
          }).then((result) => {
            if (result.isConfirmed) {
              return 1;
            } else {
              return 0;
            }
          });
        }
      </script>
  </body>
</html>