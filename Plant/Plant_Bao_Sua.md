## 1. GIỚI THIỆU CHUNG
- Nền tảng: Ứng dụng Web được xây dựng bằng Google Apps Script, dữ liệu từ Google Sheet.
- Chức năng chính: Cho phép người dùng nhập và chỉnh sửa thông báo sửa chữa thông qua giao diện dạng Modal hỗ trợ thao tác tìm kiếm, Create - Read - Update - Delete, tạo file báo cáo

## 2. ĐẦU VÀO
### 2.1 File Danh sách SC Bắc Giang V2
 - Link: https://docs.google.com/spreadsheets/d/1AcF4se3EMZftlAoZ-YCl4GOPww9yzsIuM8CgRoleoZ0/edit?gid=1308741395#gid=1308741395
 - Danh sách sheet và cột
    •  DSUserSua: ID_USC, Đơn vị_USC, Họ và tên_USC, Email_USC, Số điện thoại_USC, UseTele_USC, Username_USC, Passwork_USC, History_USC, TimeUpdate_USC
    •  DSUserDV: ID_UDV, Tên Đơn vị_UDV, Ký hiệu_UDV, Email_UDV, Username_UDV, Passwork_UDV, Ảnh logo_UDV, History_UDV, TimeUpdate_UDV
    •  DSNhomTB: ID_NTB, Nhóm thiết bị_NTB, Ký hiệu nhóm_NTB, Ghi chú_NTB, History_NTB, TimeUpdate_NTB
    •  DSThietBi: ID_TB, Đơn vị_TB, Nhóm thiết bị_TB, Mã thiết bị_TB, Tên thiết bị_TB, Model_TB, Serial_TB, Hãng sản xuất_TB, Nước sản xuất_TB, Năm sản xuất_TB, Thời gian đưa vào sử dụng_TB, Hạn bảo hành_TB, Vị trí đặt_TB, Tình trạng thiết bị_TB, Ghi chú_TB, History_TB, TimeUpdate_TB
    •  Enum Setting: ID_EnumST, Nhóm_EnumST, Tên_EnumST

### 2.2 File Main Data SC Bắc Giang V2
 - Link: https://docs.google.com/spreadsheets/d/1LYBsUlDo42-DVIhbjsJ9aRTc-quVzSF1h_2BukeMikk/edit?gid=272074285#gid=272074285
 - Danh sách sheet và cột: 
  + Main_SC: ID_DataSC, Webhook_DataSC, Trạng thái_DataSC, Mức độ_DataSC, Đơn vị_DataSC, Người sửa_DataSC, Thiết bị_DataSC, Tình trạng thiết bị đơn vị báo_DataSC, Thời gian đơn vị báo_DataSC, Ngày khảo sát_DataSC, Tình trang thiết bị khảo sát_DataSC, Kết luận khảo sát_DataSC, Đề xuất phương án_DataSC, Ngày đề nghi_DataSC, Nội dung đề nghi_DataSC, Ngày bàn giao_DataSC, Tình trạng thiết bị bàn giao_DataSC, Ghi chú_DataSC, Họ và tên_DataSC, Số điện thoại_DataSC, Người sửa chữa_DataSC, Quyết định tổ khảo sát_DataSC, Đại diện BV 1_DataSC, Chức vụ DD BV 1_DataSC, Đại diện BV 2_DataSC, Chức vụ DD BV 2_DataSC, Đại diện BV 3_DataSC, Chức vụ DD BV 3_DataSC, Đại diện BV 4_DataSC, Chức vụ DD BV 4_DataSC, Đại diện BV 5_DataSC, Chức vụ DD BV 5_DataSC, Đại diện ĐV1 Báo sửa 1_DataSC, Chức vụ DD ĐV1 Báo sửa_DataSC, Đại diện ĐV2 Báo sửa _DataSC, Chức vụ DD ĐV2 Báo sửa_DataSC, QR Code_DataSC, History_DataSC, TimeUpdate_DataSC

### 2.2 File BM.VTTB.09.01 Giấy đề nghị sửa chữa
 - Link: https://docs.google.com/document/d/1jDqUToV79fyv3jNr_3j4HL64g_coxW3joVheIHdDWxg/edit?tab=t.0
 - Các trường nhập liệu: {{Đơn vị yêu cầu}}, {{today}}, {{month}}, {{year}}, {{Tên thiết bị}}, {{Model}}, {{Serial}}, {{Hãng sản xuất}}, {{Nước sản xuất}}, {{Năm sản xuất}}, {{Năm sử dụng}}, {{QR_CODE}}, {{id}}

### 2.3 File BM.VTTB.09.02 Biên bản khảo sát tình trạng thiết bị hỏng
 - Link: https://docs.google.com/document/d/1fGUPZNrEi2OeBsmzWqj0FWx9oZYO79z4c5c45o20pl0/edit?tab=t.0
 - Các trường nhập liệu: {{day_ngaykhaosat}}, {{month_ngaykhaosat}}, {{year_ngaykhaosat}}, {{Đơn vị yêu cầu}}, {{day_ngaydvbao}}, {{month_ngaydvbao}}, {{year_ngaydvbao}}, {{Quyết định tổ khảo sát}}, {{Đại diện BV 1}}, {{Chức vụ DD BV 1}}, {{Đại diện BV 2}}, {{Chức vụ DD BV 2}}, {{Đại diện BV 3}}, {{Chức vụ DD BV 3}}, {{Đại diện BV 4}}, {{Chức vụ DD BV 4}}, {{Đại diện BV 5}}, {{Chức vụ DD BV 5}}, {{Đại diện ĐV Báo sửa 1}}, {{Chức vụ DD ĐV Báo sửa 1}}, {{Đại diện ĐV Báo sửa 2}}, {{Chức vụ DD ĐV Báo sửa 2}}, {{Tên thiết bị}}, {{Model}}, {{Serial}}, {{Hãng sản xuất}}, {{Nước sản xuất}}, {{Năm sản xuất}}, {{Năm sử dụng}}, {{Tình trang thiết bị khảo sát}}, {{Kết luận khảo sát}}, {{Đề xuất phương án}}, {{QR_CODE}}, {{id}}


### 2.4 File BM.VTTB.09.03 Giấy đề nghị phương án sửa chữa
 - Link: https://docs.google.com/document/d/1WCtJY6wA0-fBnurYf8beZyv4PAmWtGqAPZUwoJtUntM/edit?tab=t.0
 - Các trường nhập liệu: {{day_ngaydenghi}}, {{month_ngaydenghi}}, {{year_ngaydenghi}}, {{Đơn vị yêu cầu}}, {{day_ngaydvbao}}, {{month_ngaydvbao}}, {{year_ngaydvbao}}, {{Quyết định tổ khảo sát}}, {{day_ngaykhaosat}}, {{month_ngaykhaosat}}, {{year_ngaykhaosat}}, {{Tên thiết bị}}, {{Model}}, {{Serial}}, {{Hãng sản xuất}}, {{Nước sản xuất}}, {{Năm sản xuất}}, {{Năm sử dụng}}, {{Tình trang thiết bị khảo sát}}, {{Kết luận khảo sát}}, {{Đề xuất phương án}}, {{Nội dung đề nghi}}, {{Người sửa chữa}}, {{QR_CODE}}, {{id}}


### 2.5 File BM.VTTB.09.04 Biên bản bàn giao, nghiệm thu, đưa vào sử dụng
 - Link: https://docs.google.com/document/d/1mWJutc5TZ7EIf1Mq8Gj1ludhoRahOrHodZa5SU6Qi6k/edit?tab=t.0
 - Các trường nhập liệu: {{day_ngaybangiao}}, {{month_ngaybangiao}}, {{year_ngaybangiao}}, {{quyetdinhtokhaosat}}, {{Đơn vị yêu cầu}}, {{Đại diện BV 1}}, {{Chức vụ DD BV 1}}, {{Đại diện BV 2}}, {{Chức vụ DD BV 2}}, {{Đại diện BV 3}}, {{Chức vụ DD BV 3}}, {{Đại diện BV 4}}, {{Chức vụ DD BV 4}}, {{Đại diện BV 5}}, {{Chức vụ DD BV 5}}, {{Đại diện ĐV Báo sửa 1}}, {{Chức vụ DD ĐV Báo sửa 1}}, {{Đại diện ĐV Báo sửa 2}}, {{Chức vụ DD ĐV Báo sửa 2}}, {{Tên thiết bị}}, {{Model}}, {{Serial}}, {{Hãng sản xuất}}, {{Nước sản xuất}}, {{Năm sản xuất}}, {{Năm sử dụng}}, {{Tình trang thiết bị khảo sát}}, {{Tình trạng thiết bị bàn giao}}, {{QR_CODE}}, {{id}}

## 3. MÔ TẢ GIAO DIỆN ĐĂNG NHẬP
 - Kiểm tra nội dung của "Tên đăng nhập" và "Mật khẩu" giống với Username_UDV, và Passwork_UDV trong DSUserDV
## 4. MÔ TẢ GIAO DIỆN BÁO SỬA
- Bố cục theo ảnh Bố cục.jpg, cụ thể các phần:
  + A: gồm ảnh logo (https://drive.google.com/drive/folders/1ZBHcflpz3ZqImXm5nELRD61ajZWB38zl) và tên web app: "Phần mềm quản lý sửa chữa - Bệnh viện Đa khoa Bắc Giang" 
  + B: Gồm tên người đăng nhập (giá trị tương ứng trong cột "Tên Đơn vị_UDV" sheet DSUserDV), Ảnh logo (link trong "Ảnh logo_UDV") (khi kích vào đó mở ra menu sửa thông tin, sửa mật khẩu, Đăng xuất)
  + C: Nút bấm "Thêm báo hỏng"
  + D: Vùng nhập nội dung tìm kiếm
  + E: Nút bấm "Tìm kiếm"
  + Từ H đến K là các bảng liệt kê danh sách (trong "Main_SC") các báo hỏng tương ứng tên người đăng nhập (Đơn vị_DataSC) gồm: Báo hỏng, Đang sửa, Bảo hành, Sửa ngoài. Mỗi bảng có kết cấu vào định dạng, như ảnh Bảng.jpg, cụ thể như sau:
    * A: Tên bảng và tóm tắt số lượng trong bảng (ví dụ: Danh sách BÁO HỎNG (09))
    * Cột STT: Số thứ tự các báo hỏng theo số tự nhiên từ 1 đến hết 
    * Cột Nội dung: Nội dung của báo hỏng theo cấu trúc:
"🛠️ [Tình trạng thiết bị đơn vị báo_DataSC] ⚠️ [ID_DataSC]
- Thông tin thiết bị: ♟️[Tên thiết bị_TB] ⚙️[Model_TB] ⚙️[Serial_TB] ⚙️[Nước sản xuất_TB]
- Thông tin người sửa: 👨[Họ và tên_USC] 📅[Thời gian đơn vị báo_DataSC]"
    * Cột Hành động gồm các hành động: Xem và thêm hành động đối với các bảng Bảng Báo hỏng: Sửa, xóa, Xuất file pdf, xuất file word và xem file báo cáo "BM.VTTB.09.01 Giấy đề nghị sửa chữa"
## 4.2 Mô tả các TRƯỜNG
| STT | UIWeb                        | Thực hiện                                                                                                                                                                                                                                                                                                         |
| --- | ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1   | Đơn vị yêu cầu               | - Kiểu: Textbox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Giá trị mặc định: Tên đăng nhập                                                                                                                                                                                                                 |
| 2   | Người yêu cầu                | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Có  <br> - Cho phép thêm giá trị mới ngoài danh sách: Có  <br> - Giá trị mặc định: Là tên người yêu cầu gần nhất đã được nhập trước đó thuộc cùng đơn vị  <br> - Danh sách gợi ý: Toàn bộ tên người yêu cầu đã từng được nhập của đơn vị (Họ và tên\_DataSC) |
| 3   | Số điện thoại yêu cầu        | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Có  <br> - Cho phép thêm giá trị mới ngoài danh sách: Có  <br> - Giá trị mặc định: Lấy theo giá trị Người yêu cầu đầu tiên  <br> - Danh sách gợi ý: Toàn bộ số điện thoại của Người yêu cầu từng được nhập (Số điện thoại\_DataSC)                           |
| 4   | Người sửa chữa               | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Có  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị gần nhất đã được nhập trước đó thuộc cùng đơn vị  <br> - Danh sách gợi ý: Toàn bộ Họ và tên\_USC                                                               |
| 5   | Số điện thoại người sửa chữa | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Người sửa chữa  <br> - Danh sách gợi ý: Không                                                                                                 |
| 6   | Nhóm thiết bị                | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Có  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị gần nhất đã được nhập trước đó thuộc cùng đơn vị  <br> - Danh sách gợi ý: Toàn bộ Nhóm thiết bị\_NTB                                                           |
| 7   | Mã thiết bị                  | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Có  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: "Không"  <br> - Danh sách gợi ý: Toàn bộ Mã thiết bị\_TB thuộc Nhóm thiết bị                                                                                           |
| 8   | Tên thiết bị                 | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 9   | Model                        | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 10  | Serial                       | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 11  | Hãng sản xuất                | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 12  | Nước sản xuất                | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 13  | Năm sản xuất                 | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 14  | Năm đưa vào sử dụng          | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 15  | Hạn bảo hành                 | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 16  | Vị trí đặt                   | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Không  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị tương ứng của Mã thiết bị lấy trong DSThietBi  <br> - Danh sách gợi ý: Không                                                                                |
| 17  | Tình trạng thiết bị          | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Có  <br> - Cho phép thêm giá trị mới ngoài danh sách: Có  <br> - Giá trị mặc định: (không)  <br> - Danh sách gợi ý: Toàn bộ Tình trạng thiết bị đơn vị báo\_DataSC thuộc cùng đơn vị                                                                         |
| 18  | Mức độ yêu cầu               | - Kiểu: ComboBox  <br> - Cho phép chỉnh sửa giá trị: Có  <br> - Cho phép thêm giá trị mới ngoài danh sách: Không  <br> - Giá trị mặc định: Giá trị gần nhất đã được nhập trước đó thuộc cùng đơn vị  <br> - Danh sách gợi ý: Toàn bộ giá trị với "Nhóm\_EnumST" bằng "Mức độ YC" Enum Setting                     |
| 20  | Ghi chú                      | - Kiểu: Textbox  <br> - Cho phép chỉnh sửa giá trị: Có  <br> - Giá trị mặc định: (không)                                                                                                                                                                                                                          |
* Tham khảo định dạng và hỉnh ảnh của các trường  nhập trong file báo sửa.html, thư mục Tham khảo.

## 5. Liên hệ giữa sheet Main_SC và các trường trong GIAO DIỆN BÁO SỬA
| Cột                                    | Giao diện UI          | Ghi chú                                                                                                                                                                                                                                                                                                                                                                                                                      |
| -------------------------------------- | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ID\_DataSC                             |                       | Tự động sinh ra khi thêm báo sửa mới, theo định dạng:<br>SC.YYYY.yymmdd.ZZZZZ<br>SC: Viết tắt từ Sửa chữa<br>YYYY: Ký hiệu khoa/trung tâm<br>yymmdd: Năm – tháng – ngày báo lỗi<br>ZZZZZ: Số tự nhiên từ 00000 đến 99999, tăng dần theo số lỗi tại các khoa/trung tâm (đến 01/01 hằng năm sẽ reset về giá trị 00000)<br>Ví dụ: SC. KCAPC.241129.00005<br>Báo lỗi tại khoa Cấp Cứu, ngày 29/11/2024, lỗi báo thứ 5 trong năm. |
| Webhook\_DataSC                        |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Trạng thái\_DataSC                     |                       | "Em001"                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Mức độ\_DataSC                         | Mức độ yêu cầu        | lấy giá trị tương ứng trong cột 'ID\_EnumST'                                                                                                                                                                                                                                                                                                                                                                                 |
| Đơn vị\_DataSC                         | Đơn vị yêu cầu        | lấy giá trị tương ứng trong cột 'ID\_UDV'                                                                                                                                                                                                                                                                                                                                                                                    |
| Người sửa\_DataSC                      | Người sửa chữa        | lấy giá trị tương ứng trong cột 'ID\_USC'                                                                                                                                                                                                                                                                                                                                                                                    |
| Thiết bị\_DataSC                       | Tên thiết bị          | lấy giá trị tương ứng trong cột 'ID\_TB'                                                                                                                                                                                                                                                                                                                                                                                     |
| Tình trạng thiết bị đơn vị báo\_DataSC | Tình trạng thiết bị   |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Thời gian đơn vị báo\_DataSC           |                       | Lấy thời điểm ghi                                                                                                                                                                                                                                                                                                                                                                                                            |
| Ngày khảo sát\_DataSC                  |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Tình trạng thiết bị khảo sát\_DataSC   |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Kết luận khảo sát\_DataSC              |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Đề xuất phương án\_DataSC              |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Ngày đề nghị\_DataSC                   |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Nội dung đề nghị\_DataSC               |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Ngày bàn giao\_DataSC                  |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Tình trạng thiết bị bàn giao\_DataSC   |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Ghi chú\_DataSC                        | Ghi chú               |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Họ và tên\_DataSC                      | Người yêu cầu         |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Số điện thoại\_DataSC                  | Số điện thoại yêu cầu |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Quyết định tổ khảo sát\_DataSC         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Đại diện BV 1\_DataSC                  |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Chức vụ DD BV 1\_DataSC                |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Đại diện BV 2\_DataSC                  |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Chức vụ DD BV 2\_DataSC                |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Đại diện BV 3\_DataSC                  |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Chức vụ DD BV 3\_DataSC                |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Đại diện BV 4\_DataSC                  |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Chức vụ DD BV 4\_DataSC                |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Đại diện BV 5\_DataSC                  |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Chức vụ DD BV 5\_DataSC                |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Đại diện ĐV1 Báo sửa 1\_DataSC         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Chức vụ DD ĐV1 Báo sửa\_DataSC         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Đại diện ĐV2 Báo sửa \_DataSC          |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Chức vụ DD ĐV2 Báo sửa\_DataSC         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| QR Code\_DataSC                        |                       |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| History\_DataSC                        |                       | Thêm nội dung theo dạng:<br>"- Ngày " & TEXT(\[TimeUpdate\_DataSC], "dd/mm/yyyy hh\:mm\:ss") & " <br>   \* " & \[Người yêu cầu] ": " & "Báo sửa" & <br>(if(\[Ghi chú] = "", "", "<br>   \* Ghi chú:" & \[Ghi chú])                                                                                                                                                                                                           |
| TimeUpdate\_DataSC                     |                       | Thời điểm ghi                                                                                                                                                                                                                                                                                                                                                                                                                |

## 6 THỰC HIỆN
### Giai đoạn I: Xây dựng code và debug
•	Mục tiêu: Phát triển đầy đủ từng bước xử lý, kiểm tra luồng logic và dữ liệu.
•	Yêu cầu bắt buộc: Tại tất cả các bước chính và các hàm xử lý, thêm vào mảng msgData theo chuẩn nội dung sau: cột 1 là thời gian, cột 2: ('[Tên hàm / bước xử lý] - [Tên biến / mô tả dữ liệu]: ' + JSON.stringify(giá_trị_biến)), ở cuối chương trình thì ghi vào file: https://docs.google.com/spreadsheets/d/1afHg9kN6L044ySLqZU63MB7Pc-XQ43GcdYbcowR4CO4/edit?gid=0#gid=0
•	Mục tiêu sử dụng Logger:
  o	Xác định chính xác vị trí code đang chạy.
  o	Theo dõi giá trị biến theo từng bước.
  o	Hỗ trợ xác định lỗi và kiểm tra dữ liệu đầu ra trung gian.

### Giai đoạn II: Hoàn Thiện và Tối Ưu Code
•	Mục tiêu: Làm sạch mã nguồn, cải thiện hiệu suất và cấu trúc logic.
#### Bước 1: Cấu trúc lại toàn bộ code hợp lý khoa học, chuẩn hóa tên biến/hàm, đảm bảo các yêu cầu trong ## 8. QUY TẮC. Lưu ý: Không sửa nội dung trong hàm indexOf()

#### Bước 2: Xoá bỏ tất cả Logger.log() không còn cần thiết.

## 8. QUY TẮC
I. QUY TẮC ĐẶT TÊN VÀ CẤU TRÚC BIẾN
-----------------------------------
- Cấu trúc: [Tiền tố loại biến]_[Phạm vi]_[Mô tả chính]
- Tiền tố loại biến:  n (number), s (string), is (boolean), arr, arr2, idx, val, len,  rng, obj, wb, ws, col, row, tab, cel
- Phạm vi:  Sheet, Table, Range, Global, ...
- Mô tả chính:  ID, Total, Status, Count, ...
- Nhóm biến:  CONFIG_*, STATE_*, TEMP_* để dễ quản lý

II. CẤU TRÚC VÀ TỔ CHỨC MÃ NGUỒN
--------------------------------
- Viết mã ngắn gọn, có cấu trúc rõ ràng
- Tách logic thành các module nhỏ, dễ bảo trì
- Ưu tiên sử dụng pure functions (hàm thuần túy)
- Tách biệt phần xử lý dữ liệu và phần giao diện (UI)
- Comment phân vùng:  ===== N. TÊN PHẦN =====

III. QUY ƯỚC CÚ PHÁP (ES6+)
-------------------------
- Dùng `let`, `const` (KHÔNG dùng `var`)
- Arrow function: `() => { }`
- Destructuring: `const {a, b} = obj`
- Tránh: `eval()`, `with`
- Tuân thủ nguyên tắc DRY (Don’t Repeat Yourself)

IV. HIỆU SUẤT VÀ TỐI ƯU HÓA
---------------------------
- Giảm số lần gọi API không cần thiết
- Ưu tiên xử lý theo lô (batch), dùng `map()`, `filter()`, `reduce()`
- Dùng `CacheService` nếu dữ liệu ít thay đổi

V. XỬ LÝ LỖI VÀ BẢO MẬT
-----------------------
- Dùng `try-catch` để bắt lỗi
- Thông báo lỗi bằng tiếng Việt rõ ràng
- Validate input trước khi xử lý